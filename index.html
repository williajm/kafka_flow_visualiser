<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kafka Flow Visualizer - Interactive Learning Tool</title>
    <meta name="description" content="Learn Apache Kafka concepts through beautiful, interactive visualizations">

    <!-- Security: Content Security Policy -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' https://cdnjs.cloudflare.com https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.jsdelivr.net; font-src 'self' https://fonts.gstatic.com; img-src 'self' data:; connect-src 'self'; object-src 'none'; base-uri 'self'; frame-ancestors 'none';">

    <!-- Google Fonts - Organic Typography -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <!-- Custom CSS (loads after Bootstrap to override) -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/bootstrap-theme.css">

    <!-- GSAP Animation Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"
            integrity="sha384-g4NTh/Iv5PPU4xPyhEWqPcwtNXOvdaDI8LLnyYfyNZOjKJeYQyjzQ9X5275eBjpt"
            crossorigin="anonymous"></script>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark sticky-top kafka-navbar">
        <div class="container-fluid px-3 px-lg-4">
            <button class="btn btn-outline-secondary d-lg-none me-2 kafka-menu-btn" type="button" data-bs-toggle="offcanvas" data-bs-target="#lessonsOffcanvas" aria-controls="lessonsOffcanvas" aria-label="Open lessons menu">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 12h18M3 6h18M3 18h18"/>
                </svg>
            </button>
            <a class="navbar-brand kafka-logo" href="#">Kafka Flow Visualizer</a>
            <a href="https://github.com/williajm/kafka_flow_visualiser" target="_blank" rel="noopener noreferrer" class="btn btn-outline-secondary kafka-github-btn">
                <svg width="20" height="20" viewBox="0 0 16 16" fill="currentColor" class="me-2">
                    <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
                </svg>
                <span class="d-none d-sm-inline">GitHub</span>
            </a>
        </div>
    </nav>

    <!-- Offcanvas Sidebar for Lessons -->
    <div class="offcanvas offcanvas-start kafka-offcanvas" tabindex="-1" id="lessonsOffcanvas" aria-labelledby="lessonsOffcanvasLabel">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title text-uppercase small fw-semibold text-muted" id="lessonsOffcanvasLabel">Lessons</h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body p-0">
            <ul class="list-group list-group-flush kafka-lesson-list" id="lessonList">
                <li class="list-group-item kafka-lesson-item active" data-lesson="basics">
                    <span class="kafka-lesson-number">1</span>
                    <span class="kafka-lesson-name">The Basics</span>
                    <span class="kafka-lesson-status"></span>
                </li>
                <li class="list-group-item kafka-lesson-item locked" data-lesson="partitions">
                    <span class="kafka-lesson-number">2</span>
                    <span class="kafka-lesson-name">Partitions</span>
                    <span class="kafka-lesson-status"></span>
                </li>
                <li class="list-group-item kafka-lesson-item locked" data-lesson="partitions-keys">
                    <span class="kafka-lesson-number">3</span>
                    <span class="kafka-lesson-name">Partitions with Keys</span>
                    <span class="kafka-lesson-status"></span>
                </li>
                <li class="list-group-item kafka-lesson-item locked" data-lesson="partitioner-strategies">
                    <span class="kafka-lesson-number">4</span>
                    <span class="kafka-lesson-name">Sticky Partitioner</span>
                    <span class="kafka-lesson-status"></span>
                </li>
                <li class="list-group-item kafka-lesson-item locked" data-lesson="consumer-groups">
                    <span class="kafka-lesson-number">5</span>
                    <span class="kafka-lesson-name">Consumer Groups</span>
                    <span class="kafka-lesson-status"></span>
                </li>
                <li class="list-group-item kafka-lesson-item locked" data-lesson="offsets">
                    <span class="kafka-lesson-number">6</span>
                    <span class="kafka-lesson-name">Offsets & Lag</span>
                    <span class="kafka-lesson-status"></span>
                </li>
                <li class="list-group-item kafka-lesson-item locked" data-lesson="rebalancing">
                    <span class="kafka-lesson-number">7</span>
                    <span class="kafka-lesson-name">Rebalancing</span>
                    <span class="kafka-lesson-status"></span>
                </li>
            </ul>
        </div>
    </div>

    <!-- Main Layout -->
    <div class="container-fluid p-0">
        <div class="row g-0 kafka-main-row">
            <!-- Desktop Sidebar -->
            <aside class="col-lg-3 col-xl-2 d-none d-lg-block kafka-sidebar" id="sidebar">
                <nav class="kafka-lesson-nav p-3">
                    <h2 class="text-uppercase small fw-semibold text-muted mb-3">Lessons</h2>
                    <ul class="list-group list-group-flush kafka-lesson-list" id="lessonListDesktop">
                        <li class="list-group-item kafka-lesson-item active" data-lesson="basics">
                            <span class="kafka-lesson-number">1</span>
                            <span class="kafka-lesson-name">The Basics</span>
                            <span class="kafka-lesson-status"></span>
                        </li>
                        <li class="list-group-item kafka-lesson-item locked" data-lesson="partitions">
                            <span class="kafka-lesson-number">2</span>
                            <span class="kafka-lesson-name">Partitions</span>
                            <span class="kafka-lesson-status"></span>
                        </li>
                        <li class="list-group-item kafka-lesson-item locked" data-lesson="partitions-keys">
                            <span class="kafka-lesson-number">3</span>
                            <span class="kafka-lesson-name">Partitions with Keys</span>
                            <span class="kafka-lesson-status"></span>
                        </li>
                        <li class="list-group-item kafka-lesson-item locked" data-lesson="partitioner-strategies">
                            <span class="kafka-lesson-number">4</span>
                            <span class="kafka-lesson-name">Sticky Partitioner</span>
                            <span class="kafka-lesson-status"></span>
                        </li>
                        <li class="list-group-item kafka-lesson-item locked" data-lesson="consumer-groups">
                            <span class="kafka-lesson-number">5</span>
                            <span class="kafka-lesson-name">Consumer Groups</span>
                            <span class="kafka-lesson-status"></span>
                        </li>
                        <li class="list-group-item kafka-lesson-item locked" data-lesson="offsets">
                            <span class="kafka-lesson-number">6</span>
                            <span class="kafka-lesson-name">Offsets & Lag</span>
                            <span class="kafka-lesson-status"></span>
                        </li>
                        <li class="list-group-item kafka-lesson-item locked" data-lesson="rebalancing">
                            <span class="kafka-lesson-number">7</span>
                            <span class="kafka-lesson-name">Rebalancing</span>
                            <span class="kafka-lesson-status"></span>
                        </li>
                    </ul>
                </nav>
            </aside>

            <!-- Main Canvas Area -->
            <main class="col-12 col-lg-9 col-xl-10 kafka-main-content">
                <div class="kafka-canvas-container">
                    <svg id="canvas" class="kafka-visualization-canvas" viewBox="0 0 1200 600" preserveAspectRatio="xMidYMid meet">
                        <defs>
                            <!-- Gradients - Organic Earth Theme -->
                            <linearGradient id="producerGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:#C2785C;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#A65D42;stop-opacity:1" />
                            </linearGradient>
                            <linearGradient id="topicGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:#7B9E7B;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#5C7A5C;stop-opacity:1" />
                            </linearGradient>
                            <linearGradient id="consumerGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:#6B9E9E;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#4A7A7A;stop-opacity:1" />
                            </linearGradient>

                            <!-- Filters for glow effects -->
                            <filter id="glow">
                                <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
                                <feMerge>
                                    <feMergeNode in="coloredBlur"/>
                                    <feMergeNode in="SourceGraphic"/>
                                </feMerge>
                            </filter>
                        </defs>

                        <!-- Content will be injected by JavaScript -->
                        <g id="visualization"></g>
                    </svg>

                    <!-- Lesson Description - Collapsible Card -->
                    <div class="kafka-lesson-description" id="lessonDescription">
                        <div class="card kafka-description-card">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-start">
                                    <h5 class="card-title kafka-lesson-title mb-2"></h5>
                                    <button class="btn btn-sm btn-link text-muted p-0 d-lg-none kafka-collapse-btn" type="button" data-bs-toggle="collapse" data-bs-target="#lessonTextCollapse" aria-expanded="true" aria-controls="lessonTextCollapse">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="kafka-chevron">
                                            <path d="M18 15l-6-6-6 6"/>
                                        </svg>
                                    </button>
                                </div>
                                <div class="collapse show" id="lessonTextCollapse">
                                    <p class="card-text kafka-lesson-text mb-0"></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Info Panel (slides in from right) -->
    <div class="offcanvas offcanvas-end kafka-info-panel" tabindex="-1" id="infoPanel" aria-labelledby="infoPanelLabel">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="infoPanelLabel">Details</h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body" id="infoPanelContent">
            <!-- Dynamic content injected by JavaScript -->
        </div>
    </div>

    <!-- Floating Menu Button (visible only when navbar is hidden on mobile) -->
    <button class="btn kafka-floating-menu-btn position-fixed" type="button" data-bs-toggle="offcanvas" data-bs-target="#lessonsOffcanvas" aria-controls="lessonsOffcanvas" aria-label="Open lessons menu" id="floatingMenuBtn">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 12h18M3 6h18M3 18h18"/>
        </svg>
    </button>

    <!-- Control Panel (floating) -->
    <div class="kafka-controls position-fixed" id="controls">
        <div class="btn-group me-2" role="group" aria-label="Playback controls">
            <button type="button" class="btn kafka-control-btn kafka-control-btn-primary" id="playPauseBtn" aria-label="Play/Pause">
                <svg class="play-icon" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M8 5v14l11-7z"/>
                </svg>
                <svg class="pause-icon hidden" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z"/>
                </svg>
            </button>
            <button type="button" class="btn kafka-control-btn" id="resetBtn" aria-label="Reset">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
                    <path d="M21 3v5h-5"/>
                </svg>
            </button>
        </div>
        <div class="kafka-speed-control d-flex align-items-center">
            <label for="speedSlider" class="me-2 small text-muted">Speed:</label>
            <input type="range" class="form-range kafka-speed-slider" id="speedSlider" min="0.5" max="3" step="0.5" value="1">
            <span id="speedValue" class="ms-2 small fw-bold kafka-speed-value">1x</span>
        </div>
    </div>

    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    <!-- JavaScript Modules -->
    <script type="module" src="js/main.js"></script>
</body>
</html>
